# Revoice 次担当者向け実装プロンプト

## 現在の状況
- Electron メイン・レンダラー・Python CLI は稼働済みで、faster-whisper の既定設定のみをサポート。
- 履歴データは SQLite (`history.db`) に永続化され、保持ポリシー（推奨 / カスタム）と出力スタイル設定も反映済み。
- マルチタブ UI とジョブキューは実装済み。最大4件まで同時実行され、5件目以降は待機キューに積まれる。
- モデルプロファイルや複雑なプリセット UI は提供していない（当面は固定運用）。

## 次に実装すべき項目（PLAN.md 参照）
1. **ジョブイベント閲覧 UI**
   - `job_events` テーブルに蓄積されたイベントをタブ内で確認できるビューを追加。
   - `jobs:event` のログを再利用しつつ、絞り込みやコピーを行えるようにする。

2. **タブ削除時の挙動整理**
   - タブを閉じる際に関連ジョブをキャンセルするかバックグラウンド維持かを選択できるよう仕様化。
   - 待機キューに残っているジョブの扱い（自動キャンセル / 再アサイン）を定義し、ログへ明示する。

3. **待機キューの可視化と操作**
   - タブUIで待機中ジョブの順番と推定待機時間を表示。
   - 必要に応じてキュー順を変更・キャンセルできるアクションを検討。

4. **リグレッションテストの整備**
   - 4件同時実行＋待機→完了のハッピーパスを自動テストまたはスクリプトで検証できる状態をつくる。

## 補足メモ
- faster-whisper 以外のモデル切り替えやプロファイル編集 UI は追加しない。必要になった場合のみ別チケットで再検討する。
- `historyStorage` にはタブ／ジョブの CRUD が揃っているため、ロジック拡張時はここを経由すること。
- ログメッセージは `[SYSTEM]` / `[PROGRESS]` / `[ERROR]` のフォーマットを守り、ユーザーの再現手順が追えるよう記録する。

## 最低限の確認項目
1. `./start-revoice.sh` でアプリが起動し、最大4件までの並列実行と待機キューへの積み込みが動作すること。
2. 待機ジョブをキャンセルした際に UI とログが同期すること。
3. 履歴・保持ポリシー・出力スタイルの設定変更が再起動後も保持されること。

---
このファイルをプロンプトとして引き継ぎ、上記タスクを順に実装してください。
