# Revoice 次担当者向け実装プロンプト

## 現在の状況
- Electron メイン・レンダラー・Python CLI の基盤は動作済み。
- 履歴データは SQLite (`history.db`) に永続化され、一覧読み込み・追加・削除 API が整備済み。
- フロントエンドは GitHub 風ライトテーマへ刷新済みで、履歴タブはページネーション・総件数表示・失敗ジョブの保存に対応。

## 次に実装すべき項目（最新）
1. **変換ジョブの通知とUX向上**
   - 変換完了時に OS 通知とトーストを表示し、Finder/Explorer で開く導線を追加。
   - 変換ログの要約をトップレベルの `[SYSTEM]` ログにも転送し、失敗時のリトライ／再実行ボタンを検討する。

2. **変換履歴ビューとクリーンアップ**
   - SQLite `jobs` テーブルの `type='conversion'` を用いて「変換履歴」タブを実装し、成功・失敗ジョブを時系列で参照できるようにする。
   - 完了後のジョブを一定期間で自動削除する設定（上限件数／日数）を `settings.conversion.retention` で保持し、メインプロセスで定期的に掃除する。

3. **自動テストと FFmpeg 健全性チェック**
   - CI またはスクリプトでサンプル動画→音声変換を行う回帰テストを追加。
   - メインプロセス起動時に FFmpeg / FFprobe の存在チェックを行い、見つからない場合は UI に明示的なアラートを出す。

## 補足メモ
- 開発全般の参照: `AGENTS.md` 15節に UI 方針・依存関係・テスト観点を記載。
- 変換履歴は `jobs` テーブルに保存済み。UI で参照する際は `metadata.preset` や `outputBytes` を活用する。
- FFmpeg の分解能によってはサンプリングレート変換に時間がかかるので、ログ内の ETA 表示や進捗計算を調整しても良い。

## 最低限の確認項目
1. `./start-revoice.sh` でアプリが起動し、変換完了時に通知・ログが期待通り表示されること。
2. 変換履歴タブでジョブが参照・削除でき、保持ポリシーが動作すること。
3. FFmpeg/FFprobe が見つからない環境で適切な警告とフォールバックが行われること。

---
このファイルをプロンプトとして引き継ぎ、上記タスクを順に実装してください。
